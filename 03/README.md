# 第3章 確率と確率分布

## 3.1 このテーマの重要性

統計学において、確率と確率分布は中心的な役割を果たす。データ分析を行う上で、データがどのような確率的なメカニズムによって生成されたのかを理解することは、適切な分析手法を選択し、正しい解釈を行うために不可欠である。この章を通して、確率と確率分布の重要性を改めて認識した。

## 3.2 確率

確率は、ある事象が起こる可能性を数値で表したものである。0から1までの値をとり、0は絶対に起こらないことを、1は必ず起こることを意味する。確率を考える際には、以下の点に注意する必要がある。

*   **試行 (Trial):** 何らかの現象を観察したり、実験を行ったりすること。
*   **事象 (Event):** 試行の結果として起こりうる具体的な出来事。
*   **確率の定義：** 古典的な定義では、起こりうる全ての場合の数（標本空間）に対する、ある事象が起こる場合の数の割合として確率を定義する。例えば、サイコロを1回振る試行において、1の目が出る確率は1/6である。

## 3.3 確率変数と確率分布

*   **確率変数 (Random Variable):** 取りうる値が確率によって決まる変数のこと。確率変数は、第2章で学んだデータの種類と関連付けられ、離散型と連続型に分けられる。
    *   **離散型確率変数：** 取りうる値が飛び飛びの値（整数など）である変数。例えば、サイコロの目（質的データの一種である名義尺度と関連付けられる）、コインの表裏の回数など（量的データの一種である比例尺度と関連付けられる）。
    *   **連続型確率変数：** 取りうる値が連続的な値（実数など）である変数。例えば、人の身長、気温など（量的データの一種である比例尺度と関連付けられる）。
*   **確率分布 (Probability Distribution):** 確率変数がどのような値をとるかを確率で表したもの。
    *   **確率質量関数 (Probability Mass Function, PMF):** 離散型確率変数に対して、各値をとる確率を表す関数。例えば、サイコロの各目が出る確率はPMFで表される。
    *   **確率密度関数 (Probability Density Function, PDF):** 連続型確率変数に対して、ある範囲の値をとる確率を表す関数。ある特定の値をとる確率は0となる。例えば、人の身長の分布はPDFで表される。

確率変数と確率分布の概念を理解することで、様々な現象を確率的なモデルとして捉えることができるようになる。

## 3.4 二項分布（Binomial distribution, Bernoulli distribution）

二項分布は、成功確率が一定である独立な試行を複数回行った場合に、成功する回数の確率分布を表す。

*   **ベルヌーイ試行 (Bernoulli Trial):** 結果が成功か失敗の2通りしかない試行。例えば、コインを1回投げる試行。
*   **二項分布の確率質量関数：** n回の独立なベルヌーイ試行で、成功確率pの試行でk回成功する確率は、以下の式で表される。

    $$
    P(X=k) = \binom{n}{k} p^k (1-p)^{n-k}
    $$

    ここで、$\binom{n}{k} = \frac{n!}{k!(n-k)!}$ である。

二項分布は、例えば、製品の検査で不良品の個数を数える場合などに用いられる。特に試行回数nが大きく、成功確率pが小さい場合に、後述するポアソン分布で近似できることを学んだ。

## 3.5 ポアソン分布（Poisson distribution）

ポアソン分布は、単位時間あたりに平均λ回起こる事象が、ある時間内にk回起こる確率を表す離散確率分布である。例えば、1時間あたりの電話の着信回数、1平方メートルあたりの植物の個体数などがポアソン分布に従う現象の例として挙げられる。

*   **ポアソン分布の確率質量関数：**

    $$
    P(X=k) = \frac{e^{-\lambda} \lambda^k}{k!}
    $$

ポアソン分布は、例えば、交通事故の発生件数や、ウェブサイトへのアクセス数などを分析する場合に用いられる。ポアソン分布は、二項分布において試行回数nが非常に大きく、成功確率pが非常に小さい場合の近似として導出できることを学んだ。具体的には、$n \to \infty$, $p \to 0$, $np \to \lambda$のときに、二項分布はポアソン分布に近づく。稀に起こる事象の確率を扱う際に非常に有用な分布である。